{% extends 'main/layout.html' %}
{% block content %}
<div>
  <div>
    <div>
      <div>
        <div>
          <h2>Your Cart</h2>
          {% if messages %}
            <div>
              {% for message in messages %}
                {{ message }}
              {% endfor %}
            </div>
          {% endif %}
          {% if cart_items %}
            <ul>
              {% for item in cart_items %}
                <li>
                  <span>{{ item.pizza.name }} x {{ item.quantity }} ({{ item.get_subtotal|floatformat:2 }} $)</span>
                  <a href="{% url 'remove_from_cart' item.id %}">Remove</a>
                </li>
              {% endfor %}
            </ul>
            <h4>Total: {{ total_price|floatformat:2 }} $</h4>
            <div>
              <a href="{% url 'place_order' %}" >Place Order</a>
            </div>
          {% else %}
            <p >Your cart is empty.</p>
          {% endif %}
          <h3>Active Orders</h3>
          {% if active_orders %}
            <ul>
              {% for order in active_orders %}
                <li>
                  <strong>Order #{{ order.id }}</strong> - {{ order.get_status_display }} ({{ order.total_price|floatformat:2 }} $)
                  <ul>
                    {% for item in order.orderitem_set.all %}
                      <li>{{ item.pizza.name }} x {{ item.quantity }} ({{ item.get_subtotal|floatformat:2 }} $)</li>
                    {% endfor %}
                  </ul>
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No active orders.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}